$(function(){"use strict";function e(e){var t=e.reduce(function(e,t){return e+t})/e.length;return t.toFixed(2)}function t(e){var t,n=e.sort(e),a=Math.floor(n.length/2);if(n.length%2===0){var r=n[a],u=n[a-1];t=(r+u)/2}else t=n[a];return t.toFixed(2)}function n(n){var a=[],r=["x"],u=["Median Temperature"],o=["Mean Temperature"],i=["Median Pressure"],s=["Mean Pressure"],p=["Median Speed"],l=["Mean Speed"];for(var c in n)n.hasOwnProperty(c)&&null!==n[c].t&&null!==n[c].p&&null!==n[c].s&&(r.push(c),u.push(t(n[c].t)),o.push(e(n[c].t)),i.push(t(n[c].p)),s.push(e(n[c].p)),p.push(t(n[c].s)),l.push(e(n[c].s)));return a.push(r,u,o,i,s,p,l),a}function a(e){c3.generate({bindto:"#chart",data:{x:"x",columns:e,type:"bar",groups:[["Median Temperature","Mean Temperature","Median Pressure","Mean Pressure","Median Speed","Mean Speed"]]},bar:{width:{ratio:.7}},axis:{x:{type:"timeseries",tick:{format:"%Y-%m-%d"}}}})}function r(){$.ajax({url:"http://foundationphp.com/phpclinic/podata.php?&raw&callback=?",jsonpCallback:"jsonReturnData",dataType:"jsonp",data:{startDate:u(o,""),endDate:u(i,""),format:"json"},success:function(e){a(n(e))}})}function u(e,t){var n=new Date(e),a=n.getUTCMonth()+1,r=n.getUTCDate(),u=n.getUTCFullYear();return 9>=a&&(a="0"+a),9>=r&&(r="0"+r),""+u+t+a+t+r}var o,i;o=new Date,o.setDate(o.getDate()-31),i=new Date,i.setDate(i.getDate()-1);var s=$('form[name="rangeform"]'),p=s.find('input[name="from"]'),l=s.find('input[name="to"]');p.val(u(o,"-")),l.val(u(i,"-")),s.change(function(){o=new Date($(this).find('input[name="from"]').val()),i=new Date($(this).find('input[name="to"]').val()),console.log(o),o=o.toUTCString(),i=i.toUTCString(),console.log(o),r()}),r()});